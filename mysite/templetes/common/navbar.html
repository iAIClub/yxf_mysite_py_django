<!-- Brand and toggle get grouped for better mobile display -->
<nav class="navbar navbar-default navbar-fixed-top" id="navbar">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false" aria-controls="navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand hidden-sm hidden-md hidden-lg" href="javascript:;" title="侧边栏"><span class="glyphicon glyphicon-th-list"></span></a>
        <a class="navbar-brand" href="/" title="主页"><span class="glyphicon glyphicon-home"></span></a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="{% url 'app_tutorial' %}">文档</a></li>
          <li><a href="{% url 'app_blog' %}">博客</a></li>
          <li><a href="{% url 'app_webtrans' %}">网络</a></li>
          <li><a href="{% url 'app_visual' %}">视觉</a></li>
          <li><a href="{% url 'app_metaphysics' %}">数术</a></li>
          <li><a href="{% url 'app_spider' %}">爬虫</a></li>
          <li class="dropdown">
            <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">其他<span class="caret"></span></a>
            <ul class="dropdown-menu">
              <li><a href="{% url 'app_webtrans' %}">微信</a></li>
              <li><a href="{% url 'app_visual' %}">地图</a></li>
              <li><a href="{% url 'app_visual' %}">游戏</a></li>
              <li role="separator" class="divider"></li>
              <li><a href="{% url 'app_spider' %}">spider API</a></li>
              <li><a href="{% url 'app_webtrans' %}">tcp API</a></li>
            </ul>
          </li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          {% if request.user.is_superuser %}
            <li><a href="/admin/" id="a-admin" title="管理员功能：后台">后台</a></li>
            <li><a href="{% url 'settings' %}" id="a-settings" title="管理员功能：设置">设置</a></li>
          {% else %}
          {% endif %}
          <li class="dropdown">
            <a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false" id="nav-username">
              <span class="glyphicon glyphicon-user"></span>
                {% if request.user.is_authenticated %}
                  {{ request.user.username }}
                {% else %}
                  游客
                {% endif %}
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu">
              {% if request.user.is_authenticated %}
              <li><a href="{% url 'app_user_profile' %}" id="a-user-profile">用户区</a></li>
              <li role="separator" class="divider"></li>
              <li><a href="javascript:;" id="a-user-logout">登出</a></li>
              {% else %}
              <li><a href="{% url 'app_user_login' %}" id="a-user-login">登录</a></li>
              {% endif %}
              <li role="separator" class="divider"></li>
              <li><a href="{% url 'app_user_register' %}" id="a-user-register">注册新账号...</a></li>
            </ul>
          </li>
        </ul>
        <div class="navbar-form navbar-right">
          <a href="{% url 'search' %}"><button type="submit" class="btn btn-default" title="站内搜索"><span class="glyphicon glyphicon-search"></span></button></a>
        </div>
      </div><!-- /.navbar-collapse -->
     </div><!-- /.container-fluid -->
</nav>
<script type="text/javascript">
  $(function(){
  //用户登出
    $("#a-user-logout").click(function(){
      $.ajax({
        url: "{% url 'app_user_login' %}",
        type:"POST",
        timeouut:10000,
        data:{
          "purpose":"logout",
          "username":"{{ request.user.username }}",
          "csrfmiddlewaretoken":"{{ csrf_token }}"
        },
        success:function (data) {
          var parsedJson = eval(data);
          if(parsedJson.status=="logout"){window.location.reload();}
        }
      });
    });
  });
</script>